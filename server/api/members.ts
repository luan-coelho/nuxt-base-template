import { callBackend } from '../utils/backend'

const members = [
  {
    name: 'Anthony Fu',
    username: 'antfu',
    role: 'member',
    avatar: { src: 'https://ipx.nuxt.com/f_auto,s_192x192/gh_avatar/antfu' }
  },
  {
    name: 'Baptiste Leproux',
    username: 'larbish',
    role: 'member',
    avatar: { src: 'https://ipx.nuxt.com/f_auto,s_192x192/gh_avatar/larbish' }
  },
  {
    name: 'Benjamin Canac',
    username: 'benjamincanac',
    role: 'owner',
    avatar: { src: 'https://ipx.nuxt.com/f_auto,s_192x192/gh_avatar/benjamincanac' }
  },
  {
    name: 'Céline Dumerc',
    username: 'celinedumerc',
    role: 'member',
    avatar: { src: 'https://ipx.nuxt.com/f_auto,s_192x192/gh_avatar/celinedumerc' }
  },
  {
    name: 'Daniel Roe',
    username: 'danielroe',
    role: 'member',
    avatar: { src: 'https://ipx.nuxt.com/f_auto,s_192x192/gh_avatar/danielroe' }
  },
  {
    name: 'Farnabaz',
    username: 'farnabaz',
    role: 'member',
    avatar: { src: 'https://ipx.nuxt.com/f_auto,s_192x192/gh_avatar/farnabaz' }
  },
  {
    name: 'Ferdinand Coumau',
    username: 'FerdinandCoumau',
    role: 'member',
    avatar: { src: 'https://ipx.nuxt.com/f_auto,s_192x192/gh_avatar/FerdinandCoumau' }
  },
  {
    name: 'Hugo Richard',
    username: 'hugorcd',
    role: 'owner',
    avatar: { src: 'https://ipx.nuxt.com/f_auto,s_192x192/gh_avatar/hugorcd' }
  },
  {
    name: 'Pooya Parsa',
    username: 'pi0',
    role: 'member',
    avatar: { src: 'https://ipx.nuxt.com/f_auto,s_192x192/gh_avatar/pi0' }
  },
  {
    name: 'Sarah Moriceau',
    username: 'SarahM19',
    role: 'member',
    avatar: { src: 'https://ipx.nuxt.com/f_auto,s_192x192/gh_avatar/SarahM19' }
  },
  {
    name: 'Sébastien Chopin',
    username: 'Atinux',
    role: 'owner',
    avatar: { src: 'https://ipx.nuxt.com/f_auto,s_192x192/gh_avatar/atinux' }
  }
]

export default eventHandler(async event => {
  await requireUserSession(event)

  try {
    const { data } = await callBackend<typeof members | { data?: typeof members }>(event, '/api/members')

    if (Array.isArray((data as { data?: typeof members }).data)) return (data as { data?: typeof members }).data

    if (Array.isArray(data)) return data
  } catch (error) {
    console.error('Falha ao buscar membros no backend:', error)
  }

  return members
})
